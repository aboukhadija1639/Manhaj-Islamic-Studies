# Setup & Deployment Guide: Quranic Sciences Module\n\n## Quick Start\n\n### 1. Extract Content Archive\n\n```bash\n# Create content directory\nmkdir -p content/ulum-al-quran\n\n# Extract the 7z archive\n7z x علومالقرآن.7z -o./content/ulum-al-quran\n\n# Verify extraction\nls -la content/ulum-al-quran/\n```\n\n### 2. Generate Manifest\n\n```bash\n# Install dependencies (if not already installed)\nnpm install\n\n# Generate the manifest\nnpm run generate:manifest\n\n# Verify manifest was created\ncat src/modules/ulum-al-quran/manifest.generated.json\n```\n\n### 3. Add to React Router\n\nIn your main router configuration file (e.g., `src/App.tsx` or `src/routes.tsx`):\n\n```typescript\nimport { ulamAlQuranRoute } from '@/modules/ulum-al-quran/routes';\n\nconst routes = [\n  // ... other routes\n  {\n    path: '/modules',\n    children: [\n      ulamAlQuranRoute,\n      // ... other module routes\n    ],\n  },\n];\n```\n\n### 4. Start Development Server\n\n```bash\n# Development\nnpm run dev\n\n# Access the module at:\n# http://localhost:5173/modules/ulum-al-quran\n```\n\n---\n\n## File Structure\n\n```\nproject-root/\n├── content/\n│   └── ulum-al-quran/              # Content files (PDFs, markdown, images)\n│       ├── محاضرات_الدكتور_مخلوف...pdf\n│       └── محاضرات_علوم_القرآن...pdf\n│\n├── src/\n│   ├── modules/\n│   │   └── ulum-al-quran/\n│   │       ├── components/          # React components\n│   │       │   ├── ModuleShell.tsx\n│   │       │   ├── ModuleHeader.tsx\n│   │       │   ├── ModuleSidebar.tsx\n│   │       │   ├── LessonRenderer.tsx\n│   │       │   ├── SearchBox.tsx\n│   │       │   ├── SearchResults.tsx\n│   │       │   ├── TableOfContents.tsx\n│   │       │   ├── PDFRenderer.tsx\n│   │       │   └── MarkdownRenderer.tsx\n│   │       │\n│   │       ├── hooks/               # Custom React hooks\n│   │       │   ├── useLesson.ts\n│   │       │   └── useSearch.ts\n│   │       │\n│   │       ├── services/            # Business logic services\n│   │       │   ├── ProgressService.ts\n│   │       │   ├── SearchService.ts\n│   │       │   └── ContentService.ts\n│   │       │\n│   │       ├── routes/              # Router integration\n│   │       │   └── index.tsx\n│   │       │\n│   │       ├── types.ts             # TypeScript definitions\n│   │       ├── index.ts             # Module exports\n│   │       └── manifest.generated.json  # Auto-generated manifest\n│   │\n│   └── App.tsx                      # Main app with router\n│\n├── scripts/\n│   └── generate-module-manifest.ts  # Manifest generation script\n│\n├── package.json\n└── tsconfig.json\n```\n\n---\n\n## NPM Scripts\n\nAdd these scripts to your `package.json`:\n\n```json\n{\n  \"scripts\": {\n    \"dev\": \"vite\",\n    \"build\": \"tsc && vite build\",\n    \"preview\": \"vite preview\",\n    \"generate:manifest\": \"ts-node scripts/generate-module-manifest.ts\",\n    \"test\": \"vitest\",\n    \"test:e2e\": \"playwright test\",\n    \"lint\": \"eslint src --ext ts,tsx\",\n    \"type-check\": \"tsc --noEmit\"\n  }\n}\n```\n\n---\n\n## Configuration\n\n### Vite Configuration\n\nEnsure your `vite.config.ts` includes proper alias for imports:\n\n```typescript\nimport { defineConfig } from 'vite';\nimport react from '@vitejs/plugin-react';\nimport path from 'path';\n\nexport default defineConfig({\n  plugins: [react()],\n  resolve: {\n    alias: {\n      '@': path.resolve(__dirname, './src'),\n    },\n  },\n  server: {\n    port: 5173,\n  },\n});\n```\n\n### TypeScript Configuration\n\nEnsure `tsconfig.json` includes:\n\n```json\n{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"useDefineForClassFields\": true,\n    \"lib\": [\"ES2020\", \"DOM\", \"DOM.Iterable\"],\n    \"module\": \"ESNext\",\n    \"skipLibCheck\": true,\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\"src/*\"]\n    },\n    \"jsx\": \"react-jsx\"\n  },\n  \"include\": [\"src\"],\n  \"references\": [{ \"path\": \"./tsconfig.node.json\" }]\n}\n```\n\n---\n\n## Content Serving\n\n### Option 1: Static Files (Recommended)\n\nPlace content in `public/content/` and serve as static assets:\n\n```bash\nmkdir -p public/content/ulum-al-quran\ncp -r content/ulum-al-quran/* public/content/ulum-al-quran/\n```\n\nFiles will be accessible at:\n- `http://localhost:5173/content/ulum-al-quran/محاضرات...pdf`\n\n### Option 2: Import at Build Time\n\nFor smaller content, import at build time:\n\n```typescript\n// In your build script\nimport fs from 'fs';\nimport path from 'path';\n\nconst contentPath = path.join(process.cwd(), 'content/ulum-al-quran');\nconst manifest = generateManifest(contentPath);\n\n// Copy to dist\nfs.cpSync(contentPath, path.join(process.cwd(), 'dist/content/ulum-al-quran'), {\n  recursive: true,\n});\n```\n\n---\n\n## Production Build\n\n### 1. Generate Manifest\n\n```bash\nnpm run generate:manifest\n```\n\n### 2. Build Application\n\n```bash\nnpm run build\n```\n\n### 3. Verify Build\n\n```bash\n# Check that manifest is included\nls -la dist/\ngrep \"ulum-al-quran\" dist/index.html\n```\n\n### 4. Deploy\n\n```bash\n# Deploy to your hosting (Vercel, Netlify, etc.)\n# Ensure public/content/ is included in deployment\n\n# Example for Vercel:\nvercel deploy\n```\n\n---\n\n## Testing\n\n### Unit Tests\n\nCreate `src/modules/ulum-al-quran/__tests__/` directory:\n\n```bash\nnpm run test\n```\n\nExample test file:\n\n```typescript\n// src/modules/ulum-al-quran/__tests__/ProgressService.test.ts\nimport { describe, it, expect, beforeEach } from 'vitest';\nimport ProgressService from '../services/ProgressService';\n\ndescribe('ProgressService', () => {\n  let service: ProgressService;\n\n  beforeEach(() => {\n    service = new ProgressService();\n    localStorage.clear();\n  });\n\n  it('should mark lesson as completed', async () => {\n    await service.setLessonCompleted('ulum-al-quran', 'lesson-1', true);\n    const status = await service.getLessonStatus('ulum-al-quran', 'lesson-1');\n    expect(status.completed).toBe(true);\n  });\n\n  it('should calculate module progress', async () => {\n    await service.setLessonCompleted('ulum-al-quran', 'lesson-1', true);\n    await service.setLessonCompleted('ulum-al-quran', 'lesson-2', false);\n    const progress = await service.getModuleProgress('ulum-al-quran');\n    expect(progress.completedLessons).toBe(1);\n    expect(progress.totalLessons).toBe(2);\n  });\n});\n```\n\n### E2E Tests\n\nCreate `tests/ulum-al-quran.spec.ts` for Playwright:\n\n```typescript\nimport { test, expect } from '@playwright/test';\n\ntest.describe('Quranic Sciences Module', () => {\n  test('should load module and display lessons', async ({ page }) => {\n    await page.goto('http://localhost:5173/modules/ulum-al-quran');\n    await expect(page.locator('h1')).toContainText('علوم القرآن');\n  });\n\n  test('should mark lesson as complete', async ({ page }) => {\n    await page.goto('http://localhost:5173/modules/ulum-al-quran');\n    const completeBtn = page.locator('button:has-text(\"وضع علامة كمكتمل\")');\n    await completeBtn.click();\n    await expect(completeBtn).toContainText('تم الانتهاء');\n  });\n\n  test('should search lessons', async ({ page }) => {\n    await page.goto('http://localhost:5173/modules/ulum-al-quran');\n    const searchInput = page.locator('input[placeholder=\"ابحث عن درس...\"]');\n    await searchInput.fill('محاضرات');\n    await page.waitForTimeout(500);\n    const results = page.locator('[role=\"listbox\"] li');\n    await expect(results).toHaveCount(1);\n  });\n});\n```\n\nRun E2E tests:\n\n```bash\nnpm run test:e2e\n```\n\n---\n\n## Troubleshooting\n\n### Issue: Manifest not found\n\n**Solution:**\n```bash\n# Ensure script is executable\nchmod +x scripts/generate-module-manifest.ts\n\n# Run manually\nts-node scripts/generate-module-manifest.ts\n```\n\n### Issue: PDFs not loading\n\n**Solution:**\n- Check CORS headers if serving from different domain\n- Verify PDF files exist in `public/content/ulum-al-quran/`\n- Check browser console for 404 errors\n\n### Issue: Search not working\n\n**Solution:**\n- Clear localStorage: `localStorage.clear()`\n- Rebuild search index: Refresh page\n- Check manifest is valid JSON\n\n### Issue: RTL layout broken\n\n**Solution:**\n- Ensure `dir=\"rtl\"` on root element\n- Check Tailwind CSS configuration includes RTL support\n- Verify font supports Arabic characters\n\n---\n\n## Performance Optimization\n\n### 1. Code Splitting\n\n```typescript\n// Lazy load module\nconst UlamAlQuran = lazy(() =>\n  import('@/modules/ulum-al-quran')\n);\n```\n\n### 2. Image Optimization\n\n```bash\n# Convert PDFs to images for preview\npdftoppm input.pdf output -png -r 150\n```\n\n### 3. Caching Strategy\n\n```typescript\n// Service Worker for offline access\nself.addEventListener('install', (event) => {\n  event.waitUntil(\n    caches.open('ulum-al-quran-v1').then((cache) => {\n      return cache.addAll([\n        '/content/ulum-al-quran/manifest.generated.json',\n        // ... add PDF files\n      ]);\n    })\n  );\n});\n```\n\n---\n\n## Next Steps\n\n1. **Customize Styling:** Update Tailwind classes to match your brand\n2. **Add Backend Sync:** Implement ProgressService backend adapter\n3. **Enable Annotations:** Add user notes and highlights\n4. **Analytics:** Track user engagement and completion rates\n5. **Offline Support:** Implement Service Worker for offline access\n\n---\n\n## Support\n\nFor issues or questions:\n1. Check the Technical Design document\n2. Review component prop types in `types.ts`\n3. Check browser console for errors\n4. Verify manifest structure with `npm run generate:manifest`\n
