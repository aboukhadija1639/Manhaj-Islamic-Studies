/**
 * LessonRenderer - Main lesson content display\n */\n\nimport React, { useState } from 'react';\nimport { useLesson, useMarkLessonComplete } from '../hooks/useLesson';\nimport { TableOfContents } from './TableOfContents';\nimport { PDFRenderer } from './PDFRenderer';\nimport { MarkdownRenderer } from './MarkdownRenderer';\n\ninterface LessonRendererProps {\n  lessonId: string;\n  moduleId: string;\n}\n\nexport function LessonRenderer({\n  lessonId,\n  moduleId,\n}: LessonRendererProps) {\n  const { lesson, isLoading, error, isCompleted } = useLesson(\n    lessonId,\n    moduleId\n  );\n  const { markComplete, isUpdating } = useMarkLessonComplete(\n    moduleId,\n    lessonId\n  );\n  const [showTOC, setShowTOC] = useState(false);\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"text-center\">\n          <div className=\"h-8 w-8 animate-spin rounded-full border-4 border-gray-300 border-t-blue-500 mx-auto\" />\n          <p className=\"mt-4 text-gray-600\">جاري تحميل الدرس...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"text-center\">\n          <svg\n            className=\"h-12 w-12 text-red-500 mx-auto\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            viewBox=\"0 0 24 24\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M12 8v4m0 4v.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n            />\n          </svg>\n          <p className=\"mt-4 text-gray-900 font-medium\">حدث خطأ</p>\n          <p className=\"text-gray-600 text-sm\">{error.message}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!lesson) {\n    return null;\n  }\n\n  return (\n    <div className=\"flex h-full flex-col md:flex-row\">\n      {/* Main Content */}\n      <div className=\"flex-1 overflow-y-auto\">\n        <article className=\"mx-auto max-w-3xl px-4 py-8 sm:px-6 lg:px-8\">\n          {/* Breadcrumbs */}\n          <nav className=\"flex items-center gap-2 text-sm text-gray-600 mb-6\">\n            <a href=\"#\" className=\"hover:text-gray-900\">\n              {lesson.sectionTitle}\n            </a>\n            <span>/</span>\n            <span className=\"text-gray-900 font-medium\">{lesson.title}</span>\n          </nav>\n\n          {/* Header */}\n          <header className=\"mb-8 border-b border-gray-200 pb-6\">\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-4\">\n              {lesson.title}\n            </h1>\n\n            {/* Metadata */}\n            <div className=\"flex flex-wrap items-center gap-4 text-sm text-gray-600\">\n              {lesson.metadata?.duration && (\n                <div className=\"flex items-center gap-1\">\n                  <svg\n                    className=\"h-4 w-4\"\n                    fill=\"none\"\n                    stroke=\"currentColor\"\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth={2}\n                      d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"\n                    />\n                  </svg>\n                  <span>{lesson.metadata.duration} دقيقة</span>\n                </div>\n              )}\n\n              <div className=\"flex items-center gap-1\">\n                <span className=\"text-xs px-2 py-1 bg-gray-100 rounded\">\n                  {lesson.type}\n                </span>\n              </div>\n            </div>\n          </header>\n\n          {/* Content */}\n          <div className=\"prose prose-sm max-w-none\">\n            {lesson.type === 'pdf' && (\n              <PDFRenderer\n                path={(lesson.content as any).path}\n                title={lesson.title}\n              />\n            )}\n            {lesson.type === 'md' && (\n              <MarkdownRenderer\n                content={(lesson.content as any).content}\n              />\n            )}\n            {lesson.type === 'image' && (\n              <img\n                src={`/content/ulum-al-quran/${(lesson.content as any).path}`}\n                alt={lesson.title}\n                className=\"max-w-full h-auto rounded-lg\"\n              />\n            )}\n          </div>\n\n          {/* Completion Toggle */}\n          <div className=\"mt-12 border-t border-gray-200 pt-6\">\n            <button\n              onClick={() => markComplete(!isCompleted)}\n              disabled={isUpdating}\n              className={`inline-flex items-center gap-2 rounded-lg px-4 py-2 font-medium transition-colors ${\n                isCompleted\n                  ? 'bg-green-50 text-green-700 hover:bg-green-100'\n                  : 'bg-blue-50 text-blue-700 hover:bg-blue-100'\n              } disabled:opacity-50`}\n            >\n              <svg\n                className=\"h-5 w-5\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M5 13l4 4L19 7\"\n                />\n              </svg>\n              {isCompleted ? 'تم الانتهاء' : 'وضع علامة كمكتمل'}\n            </button>\n          </div>\n        </article>\n      </div>\n\n      {/* TOC Sidebar - Desktop */}\n      {lesson.toc.length > 0 && (\n        <div className=\"hidden lg:flex lg:w-64 lg:flex-col lg:border-l lg:border-gray-200 lg:bg-gray-50 lg:p-6\">\n          <h2 className=\"text-sm font-semibold text-gray-900 mb-4\">محتويات الدرس</h2>\n          <TableOfContents entries={lesson.toc} />\n        </div>\n      )}\n\n      {/* TOC Mobile Toggle */}\n      {lesson.toc.length > 0 && (\n        <button\n          onClick={() => setShowTOC(!showTOC)}\n          className=\"lg:hidden fixed bottom-6 right-6 inline-flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white shadow-lg hover:bg-blue-700\"\n        >\n          <svg\n            className=\"h-5 w-5\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            viewBox=\"0 0 24 24\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M4 6h16M4 12h16M4 18h16\"\n            />\n          </svg>\n          المحتويات\n        </button>\n      )}\n    </div>\n  );\n}\n\nexport default LessonRenderer;\n
